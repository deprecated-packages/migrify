# inspired by https://github.com/rectorphp/rector/blob/master/.travis.yml
language: php

dist: bionic

php: 7.4

jobs:
    include:
        -
            name: "Split Monorepo"
            if: (branch = master OR tag IS present) && type = push

            before_install:
                # autoload has changed on Composer 2 and is broken
                - composer self-update --1

            script:
                - composer update --ansi
                # travis_retry to prevent fails
                - travis_retry vendor/bin/monorepo-builder split --max-processes 6 --ansi
